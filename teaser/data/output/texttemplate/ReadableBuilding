<%namespace file="/modelica_language/" import="get_true_false, get_list"/> <%namespace file="/conversion/" import="deg_to_rad, azmiut_conv"/>
---- General Building Information ----

building name = ${bldg.name} -
building type = ${bldg.type_of_building} -
building year of construction = ${bldg.year_of_construction} -
building number of floors = ${bldg.number_of_floors} -
building height of floors = ${bldg.height_of_floors} m
building net leased area = ${bldg.net_leased_area} m^2

static heat load = ${round(bldg.sum_heat_load, 2)} W
static cooling load = ${round(bldg.sum_cooling_load, 2)}

number of thermal zone.model_attrs = ${len(bldg.thermal_zones)} -

%for zone in bldg.thermal_zones:
---- ${zone.name} ----

    area = ${zone.area} m2
    volume = ${zone.volume} m3
    number of outer walls = ${len(zone.outer_walls)}
    number of rooftops = ${len(zone.rooftops)}
    number of ground floors = ${len(zone.ground_floors)}
    number of exterior orientations = ${zone.model_attr.n_outer}

  * Activity, usage and systems engineering *

    usage = ${zone.use_conditions.usage}
    upper limit of heater = ${zone.model_attr.heat_load} W
    upper limit of cooler = 0 W


    Lighting

    heating power of lighting = ${zone.use_conditions.lighting_power} W/m2
    heating power of lighting = ${zone.use_conditions.profile_lighting} W/m2
    Ratio of convective heat for lighting =${zone.use_conditions.ratio_conv_rad_lighting}
    relative profile lighting =${zone.use_conditions.profile_lighting}

    Persons

    number of people in the zone= ${zone.use_conditions.persons}
    activity type of persons = ${zone.use_conditions.activity_type_persons} W/person
    Ratio of convective heat for persons =${zone.use_conditions.ratio_conv_rad_persons}
    relative profile persons =${zone.use_conditions.profile_persons}

    Machines

    number of machines in the zone= ${zone.use_conditions.machines}
    activity type of persons = ${zone.use_conditions.activity_type_machines} W/machine
    Ratio of convective heat for persons =${zone.use_conditions.ratio_conv_rad_machines}
    relative profile persons =${zone.use_conditions.profile_machines}

    Air Handling Unit

    with_ahu = ${get_true_false(zone.use_conditions.with_ahu)}
    minimum specific air flow supplied by the AHU = ${zone.use_conditions.min_ahu} m^3/(h m^2)
    maximum specific air flow supplied by the AHU = ${zone.use_conditions.max_ahu} m^3/(h m^2)
    constant infiltration usage = ${get_true_false(zone.use_conditions.use_constant_ach_rate)}
    base value for the infiltration rate = ${zone.use_conditions.base_ach} 1/h
    Additional infiltration rate for maximum persons activity = ${zone.use_conditions.max_user_ach} 1/h
    Additional infiltration rate when overheating appears  = ${zone.use_conditions.max_overheating_ach} 1/h
    Additional infiltration rate in the summer with  = ${zone.use_conditions.max_summer_ach} [infiltration_rate [1/h], Tmin [K], Tmax [K]]
    Reduction factor of userACH for cold weather with  = ${zone.use_conditions.winter_reduction} [infiltration_rate [1/h], Tmin [K], Tmax [K]]





    minimum specific air flow supplied by the AHU =  (minAHU)
    maximum specific air flow supplied by the AHU = (maxAHU)
    AHU functionality =

    total energy transmittance = ${zone.model_attr.weighted_g_value} - (g)

  * Windows *

    energy transmittances if sunblind is closed = ${sunblind_string(zone.model_attr.windows)} - (gsunblind)
    list of window areas = ${area_string(zone.windows)} - (Aw)
    windows functionality = ${on_off_checker(zone.model_attr.windows)} - (withWindows)
    weigthfactors for the windows = ${weightfactors_to_string(zone.model_attr.weightfactor_win)} - (weightfactorswindow)
    coefficient of absorption of the window = 0.03 - (awin)
    %if prj.merge_windows_calc == False:
    resistor window = ${zone.model_attr.r1_win} K/W (RWin)
    window's coefficient of heat transfer (inner side) = ${zone.model_attr.alpha_conv_inner_win} W/(m^2 K) (alphaConvWinInner)
    window's coefficient of heat transfer (outer side) = ${zone.model_attr.alpha_conv_outer_win} W/(m^2 K) (alphaConvWinOuter)
    %endif


  * Inner Walls *

    inner wall area = ${round(zone.model_attr.area_iw, 2)} m^2 (Ai)
    inner wall's coefficient of heat transfer = ${zone.model_attr.alpha_conv_inner_iw} W/(m^2 K) (alphaiwi)
    inner walls functionality = ${on_off_checker(zone.model_attr.inner_walls)} - (withInnerwalls)
    resistor 1 inner wall = ${zone.model_attr.r1_iw} K/W (R1i)
    capacity 1 inner wall = ${zone.model_attr.c1_iw} J/K  (C1i)

  * Outer Walls *

    outer wall area = ${round(zone.model_attr.area_ow, 2)} m^2 (Ao)
    outer wall's coefficient of absorption = 0.7 - (aowo)
    outer wall's coefficient of heat transfer (inner side) = ${zone.model_attr.alpha_conv_inner_ow} W/(m^2 K)  (alphaowi)
    outer wall's coefficient of heat transfer (outer side) = ${zone.model_attr.alpha_comb_outer_ow} W/(m^2 K) (alphaowo)
    weigthfactors for the walls = ${weightfactors_to_string(zone.model_attr.weightfactor_ow)} - (weightfactorswall)
    weigthfactors for the ground = ${weightfactors_to_string_ground(zone.model_attr.weightfactor_ground)} - (weightfactorground)
    outer walls functionality = ${on_off_checker(zone.model_attr.outer_walls)} - (withOuterwalls)
    resistor 1 outer wall = ${zone.model_attr.r1_ow} K/W (R1o)
    capacity 1 outer wall = ${round(zone.model_attr.c1_ow, 2)} J/K  (C1o)
    resistor "Rest" = ${zone.model_attr.r_rest_ow} K/W (RRest)


%endfor

##get n
<%def name="get_n(list)", filter="trim">
  <%
  n=0
  for element in list:
    if type(element).__name__ == "OuterWall" or type(element).__name__ == "Rooftop":
      n += 1
    else:
      pass
  return n
  %>
</%def>

##get n
<%def name="get_number_of_zones(list)", filter="trim">
  <%
  n=0
  for element in list:
    if type(element).__name__ == "ThermalZone":
      n += 1
    else:
      pass
  return n
  %>
</%def>

##on off checker
<%def name="on_off_checker(state)", filter="trim">
  <%
  if state == True:
    return "On"
  else:
    return "Off"
  %>
</%def>

##convert sunblind to string
<%def name="sunblind_string(list)", filter="trim">
  <%
  help = "["
  for element in list:
    if len(help) == 1:
      help += str(element.shading_g_total)
    else:
      help += ", " + str(element.shading_g_total)
  help += ", 0]"
  help = help.replace("[", "{").replace("]", "}")
  return help
  %>
</%def>

##convert areas to string
<%def name="area_string(list)", filter="trim">
  <%
  help = "["
  for element in list:
    if len(help) == 1:
      help += str(element.area)
    else:
      help += ", " + str(element.area)
  help += ", 0]"
  help = help.replace("[", "{").replace("]", "}")
  return help
  %>

</%def>

##check if element is existent
<%def name="element_check(element)", filter ="trim">
  <%
  if len(element)!= 0:
    return "true"
  else:
    return "false"
  %>
</%def>

##convert the weightfactors
<%def name="weightfactors_to_string(list)", filter="trim">
  <%
  help = "["
  for element in list:
    if len(help) == 1:
      help += str(element)
    else:
      help += ", " + str(element)
  help += "]"
  help = help.replace("[", "{").replace("]", "}")
  return help
  %>
</%def>

##convert the weightfactors
<%def name="weightfactors_to_string_ground(list)", filter="trim">
  <%
  help = ""
  for element in list:
    help += str(element)
  return help
  %>
</%def>
